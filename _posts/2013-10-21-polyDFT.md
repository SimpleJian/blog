---
layout: post
title: 从多项式乘法看离散傅里叶变换（DFT）
tag: Digit image process, DFT, Introduction to algorithm
---

# {{ page.title }}



离散傅里叶变换是数字信号处理中的重要内容，然而但从公式出发很难获得比较直观的理解。在工程上，我们一般将其理解为，一个长度有限的数字信号可以分解为有限个离散三角函数信号，这样一来DFT的物理意义和相关性质就比较清晰，对DFT的一些性质我们无需从公式出发进行数学推导，可以根据物理意义来理解。比如数字信号在时域的平移可以看成是有限个三角函数信号的平移，而三角函数信号的平移其时就是相位变化，对应的就是是频域的相移。其他一些时域的伸缩变换与频域的伸缩变换也可以这样来理解。但是对于卷积与乘积的关系，确实不好理解（可以看成是数字系统的响应，但还是有点抽象）。今天看完算法导论多项式相关内容，感觉对DFT有了更深的理解，特别是卷积与乘积的关系。

大学期间学Z变换的时候，我就发现Z变换的结果其实就是(1/z)的多项式，多项式的系数就是时域的数字信号。我们考虑2个多项式的乘法，(1+x)*(1+2x)=1+3x+2x^2，通过计算不难发现2点，第一，结果仍是多项式(废话)；第二，结果系数(1, 3, 2)就是原多项式系数(1, 1)和(1, 2)的卷积，这样一来就轻易理解了Z域的乘积对应于时域的卷积。Z变换好理解，离散傅里叶变换呢？你可能想当然的认为差不多，其实差远了。Z变换的结果是多项式，而DFT的结果仍是一个数字序列(一般是复数)，这跟多项式貌似没啥关系呀！其实还是有关系的(没关系我还说个鸟)。对于多项式，我们有2种表示方法，一是系数表示法，二是点值表示法。系数表示法想必大家都清楚，至于点值表示法，具体来讲，就是2个不同点可以确定一条直线(一次多项式)，3点不同点可以确定一条抛物线(二次多项式)，以此类推，我们只需要n+1个不同的点就能唯一确定一个n次多项式(姑且叫多项式采样定理吧)。从信号的角度来理解的话，结论就是，只需n+1个不同采样点就能完全恢复n次多项式信号(是不是很神奇)。DFT的结果其实就能看成一个多项式的点值表示。只是采样点比较奇葩，全是复数，N点DFT的采样点正是方程 x^N = 1 的N个复数解(复平面中圆心位于原点的单位圆上均匀分布的N条半径)。

如果知道了2个多项式A和B的点值表达，我们能不能求得多项式C=A*B的点值表达呢？首先，我们得保证A和B的点值表达是基于相同的采样点，这样 一来对应采样点处的值相乘就能得到C在该点处的值；其次，我们得保证采样点的数目足够多，设A为n次多项式，B为m次多项式，则C=A*B为n+m-1次多项式，根据“多项式采样定理”，我们至少需要n+m个采样点。综上所述，如果我们知道A和B在(n+m)个不同点处的值，那么就能得到C的点值表达。

之前提到，对应一个长为N的离散数字信号，若视其为N-1次多项式的系数，则其DFT就是该多项式的N点表达。我们要是想得到该多项式的L(L > N)点表达呢？不难想到把该信号用0补成长为L的信号，补长后的信号可以看成是L-1次多项式的系数，高次项为0而已。补长后再进行DFT就能得到多项式的L点表达。

现在有2个长度分别为n和m的离散数字信号，该如何通过DFT来计算其卷积呢？首先，2个多项式的系数卷积=多项式乘积的系数；其次，多项式系数DFT=多项式点值表达；再次，只要知道2个多项式的(n+m-1)点表达，就能求得其乘积多项式的点值表达。综上所述，卷积计算方法如下：首先，将2个信号用0补成长度为n+m-1(Why?)；其次，分别计算DFT，得到多项式的点值表达；再次，计算DFT的乘积，得到乘积多项式的点值表达；最后，计算IDFT(逆变换)，得到乘积多项式的系数，也就是原多项式系数的卷积，也即原信号的线性卷积。

注意到我们在利用DFT计算2个信号的卷积时要先把信号进行加0补长为2个信号长度之和，要是不加长或者补0后长度仍不够会出现什么情况？具体分析如下：设原信号长度分别为n和m，补0处理后的长度为N，max(n, m) <= N < n+m-1，此时进行DFT可得到多项式的N点表达，再做乘法可得乘积多项式的N个采样值，由于N<n+m-1，根据“多项式采样定理”知无法恢复n+m-1次多项式，我们进行IDFT后得到的只是一个N-1次多项式的系数，并不是乘积多项式系数的卷积，但二者之间并非毫无关联。我们知道DFT是多项式的采样值，而且采样点是方程 x^N = 1 的解，这样一来就有，x^(N+k) = x^k，对于一个高于N-1次的多项式而言，就可以将其高于N-1次的项替换成低次项，并且保证替换后的多项式在采样点处的值不变。替换操作在系数上的变化表现为，高次项的系数被累加到低次项。举个例子，L次多项式系数为[1, 1, 1, 1, 1]，若N=3，则替换后的多项式系数为[2, 2, 1]。

其实，N点DFT的乘积对应时域信号的N点循环卷积。2个长分别为n和m的信号做N点循环卷积，其结果的DFT等于原信号N点DFT的乘积，当且仅当N >= n+m-1时，循环卷积与线性卷积(通常意义下2个离散信号的卷积)才相等。正因如此，我们才能利用DFT (存在快速算法FFT)来计算线性卷积。

终于完了，写得有些混乱了……


{{ page.date | date_to_string}}

