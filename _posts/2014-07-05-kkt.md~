---
layout: post
title: 对KKT条件的理解
tags: Numerical Optimization, Nonlinear Optimization, KKT
---

# {{ page.title }}

## 带约束的数值优化问题

数值优化问题是在有限维实空间上求单值函数的极值。函数的自变量可能受限制于有限个等式或不等式约束。数值优化问题通常可以写成如下形式：

$$min f(x)$$

s.t. $$ g_i(x)\geq0, h_j(x)=0$$

其中，f(x)是优化目标，x是变量，g(x)是不等式约束，h(x)是等式约束，通常来说，所有的优化问题都可以转化为以上形式。

## 无约束优化问题的一阶必要性条件

$$\nabla f(x)=0$$


## 只含等式约束的一阶必要性条件--lagrangian methond

$$\nabla f(x) = \sum\lambda_i\nabla h_i(x)$$


## 一般优化问题的一阶必要性条件--KKT condition

$$\nabla f(x) = \sum\lambda_i\nabla h_i(x) + \sum_{\mu_j \geq 0}\mu_j\nabla g_j(x)$$

$$ \mu_j g_j(x) = 0，\quad \forall j $$


无论优化问题是否有约束，一阶必要性条件在本质上是一样的，如果某点是极值点，那么在该点处一定不存在一个可行的下降（上升）方向使函数值减小（增大），这就是极值点的一阶必要性条件，以下2种情况可以满足该条件：

* 函数在该点的梯度为0，典型的例子是无约束优化问题的一阶必要性条件；
* 函数在该点的梯度不为0，但由于约束条件的存在，无法沿梯度方向移动来使函数值发生变化。

先考虑只有一个等式约束的情况，此时自变量的可行域是一个约束面，假设$$ x $$最初位于$$ x_0 $$处，那么此时$$ x $$的移动方向肯定不能与约束面的法向量方向平行，也不能包含法向量方向的分量，否则沿该方向移动将使得$$x$$跳出约束面。所以，当目标函数的梯度方向与约束面在该点的法向量方向平行时，就找不到一个可行的合法的下降方向了（沿梯度方向移动才能下降）。用数学公式表达出来就是$$ \nabla f(x) = \lambda \nabla h(x) $$，这正是只含一个等式约束条件的一阶必要性条件。

再考虑有多个等式约束的情况，此时自变量可行域为多个约束面的交集，如果目标函数的梯度恰好可以分解为约束面的法向量线性组合，那么，沿目标函数梯度方向的移动将会违背约束条件，所以，含多个等式约束的优化问题的一阶必要性条件为：$$ \nabla f(x) = \sum \lambda_i \nabla h_i(x) $$

最后考虑含不等式约束的情况，此时的可行域是由等式约束决定的约束面以及由不等式约束决定的区域的交集。要判定 $$ x $$是否是极值点，可分以下2种情况考虑：

1. $$ x $$位于区域边界上，此时不等式约束的等号恰好成立，此时的情况可以与等式约束类比，只不过在分解梯度的时候，限定了法向量的方向；
2. $$ x $$位于区域内部，此时的不等式约束对可行方向不具约束力，在分解梯度时无需考虑，因此对应的$$ \mu_j=0 $$，这也解释了为什么要满足互补条件。

总结，优化问题的一阶必要性条件的实质是考察梯度条件，这也是为什么叫“一阶”必要性条件的原因。对于带约束的优化问题，只要将约束条件转化为对可行方向的约束，就能够比较直观地理解一阶必要性条件。
